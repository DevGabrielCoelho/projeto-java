<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    ::-webkit-scrollbar {
      width: 12px;
      height: 12px;
    }

    ::-webkit-scrollbar-track {
      padding-left: 3px;
      background: #f0f0f0;
      border-radius: 6px;
    }

    ::-webkit-scrollbar-thumb {
      padding-left: 3px;
      background-color: #888;
      border-radius: 6px;
      border: 3px solid #f0f0f0;
    }

    ::-webkit-scrollbar-thumb:hover {
      background-color: #555;
    }

    body {
      font-family: 'Roboto', Arial, sans-serif;
      margin: 0;
      background: #f8f9fb;
      color: #434861;
    }

    .dashboard-1 {
      margin-left: 0;
      padding: 32px 24px 0 24px;
      background: #f8f9fb;
      min-height: 100vh;
    }

    h2 {
      font-weight: 400;
      margin-bottom: 24px;
      color: #2e3247;
    }

    .nav-tabs {
      border-bottom: 1px solid #e1e3ed;
      margin-bottom: 0;
      padding-left: 0;
      background: #fff;
      border-radius: 8px 8px 0 0;
      box-shadow: 0 2px 8px rgba(44, 62, 80, 0.04);
    }

    .nav-tabs li {
      display: inline-block;
      margin-right: 2px;
    }

    .nav-tabs .nav-link {
      display: inline-block;
      padding: 12px 28px;
      border: none;
      background: transparent;
      color: #434861;
      border-radius: 8px 8px 0 0;
      text-decoration: none;
      cursor: pointer;
      font-size: 1.05em;
      transition: background 0.2s;
    }

    .nav-tabs .active .nav-link,
    .nav-tabs .nav-link.active {
      background: #fff;
      color: #18a689;
      font-weight: 500;
      box-shadow: 0 -2px 0 #18a689 inset;
    }

    .tab-content {
      border-radius: 0 0 8px 8px;
      background: #fff;
      padding: 32px 24px 24px 24px;
      box-shadow: 0 2px 8px rgba(44, 62, 80, 0.04);
      border: none;
    }

    .panel-body {
      padding: 0;
    }

    .table-responsive {
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 12px;
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 1px 4px rgba(44, 62, 80, 0.04);
    }

    th,
    td {
      border: none;
      padding: 12px 10px;
      text-align: left;
      font-size: 15px;
    }

    th {
      background: #f3f6fa;
      font-weight: 500;
      color: #434861;
      font-size: 1.05em;
      border-bottom: 2px solid #e1e3ed;
    }

    tr:not(:last-child) td {
      border-bottom: 1px solid #e1e3ed;
    }

    .mat-form-field {
      margin-bottom: 18px;
      display: inline-block;
      width: 280px;
      position: relative;
    }

    .mat-form-field input {
      width: 100%;
      padding: 9px 36px 9px 12px;
      border: 1px solid #e1e3ed;
      border-radius: 6px;
      font-size: 1em;
      background: #f8f9fb;
      transition: border 0.2s;
    }

    .mat-form-field input:focus {
      border: 1.5px solid #18a689;
      outline: none;
      background: #fff;
    }

    .mat-form-field .material-icons {
      position: absolute;
      right: 8px;
      top: 8px;
      color: #bfc2d4;
      cursor: pointer;
      font-size: 22px;
    }

    .mat-paginator {
      margin-top: 18px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .mat-paginator-page-size-label,
    .mat-paginator-range-label {
      font-size: 14px;
      color: #888;
    }

    .mat-paginator select {
      border: 1px solid #e1e3ed;
      border-radius: 4px;
      padding: 4px 8px;
      background: #f8f9fb;
      font-size: 14px;
      color: #434861;
    }

    .mat-paginator button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px 8px;
      color: #18a689;
      font-size: 1.3em;
      border-radius: 4px;
      transition: background 0.2s;
    }

    .mat-paginator button[disabled] {
      color: #bfc2d4;
      cursor: default;
    }

    table button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px 6px;
      border-radius: 4px;
      transition: background 0.2s;
      outline: none;
    }

    table button:hover .material-icons {
      color: #18a689;
      background: #e6f7f1;
      border-radius: 50%;
    }

    table .material-icons {
      color: #18a689;
      font-size: 22px;
      vertical-align: middle;
      transition: color 0.2s, background 0.2s;
    }

    .footer {
      margin-top: 40px;
      padding: 18px 0 30px 0;
      background: #f8f9fb;
      color: #434861;
      text-align: center;
      font-size: 0.97em;
      border-top: 1px solid #e1e3ed;
      position: fixed;
      left: 0;
      bottom: 0;
      width: 100vw;
      z-index: 10;
    }

    .pull-right {
      float: right;
      color: #888;
      font-size: 0.97em;
      margin-top: 2px;
    }

    @media (max-width: 900px) {
      .dashboard-1 {
        padding: 8px;
      }

      .tab-content {
        padding: 12px 4px;
      }

      table th,
      table td {
        padding: 8px 4px;
        font-size: 13px;
      }

      .mat-form-field {
        width: 100%;
      }
    }

    .tab-pane {
      display: none;
    }

    .tab-pane.active {
      display: block;
    }

    #modalBodyList+#notifyBtn {
      margin-top: 18px;
    }
  </style>
</head>

<body>
  <div class="dashboard-1">
    <div class="row wrapper centraliza border-bottom white-bg page-heading">
      <div>
        <h2>Assistência Técnica</h2>
      </div>
    </div>
    <div class="wrapper wrapper-content animated fadeInRight" style="padding-top: 50px;">
      <div>
        <div class="tabs-container">
          <ul class="nav nav-tabs" role="tablist">
            <li class="active"><a href="#services_tab" class="nav-link active" data-tab="services_tab">Serviços</a></li>
          </ul>
          <div class="tab-content">
            <div id="services_tab" class="tab-pane active" role="tabpanel">
              <div class="panel-body">
                <div class="table-responsive">
                  <div class="container-fluid">
                    <div style="max-height: 650px;">
                      <table>
                        <thead>
                          <tr>
                            <th>№ O.S</th>
                            <th>Cliente</th>
                            <th>CPF</th>
                            <th>Aparelho</th>
                            <th>Valor</th>
                            <th>Status Garantia</th>
                            <th></th>
                          </tr>
                        </thead>
                        <tbody>
                          %responsive-clients-tbody
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <div class="mat-paginator">
                    <span class="mat-paginator-page-size-label">Serviços por página:</span>
                    <select id="range">
                      <option value="5" %selected_5%>5</option>
                      <option value="10" %selected_10%>10</option>
                      <option value="25" %selected_25%>25</option>
                    </select>
                    <span class="mat-paginator-range-label">%client-item-index-init – %client-item-index-final de
                      %client-total-items</span>
                    <button disabled title="Previous page"><span class="material-icons">chevron_left</span></button>
                    <button title="Next page"><span class="material-icons">chevron_right</span></button>
                  </div>
                </div>
              </div>
            </div>
            <div id="historic" class="tab-pane" role="tabpanel">
              <div class="panel-body">
                <div class="table-responsive">
                  <div class="container-fluid">
                    <table>
                      <thead>
                        <tr>
                          <th>Nome</th>
                          <th>Email</th>
                        </tr>
                      </thead>
                      <tbody>
                        %responsive-clients-tbody
                      </tbody>
                    </table>
                    <div class="mat-paginator">
                      <span class="mat-paginator-page-size-label">Items per page:</span>
                      <select id="range">
                        <option value="5" %selected_5%>5</option>
                        <option value="10" %selected_10%>10</option>
                        <option value="25" %selected_25%>25</option>
                      </select>
                      <span class="mat-paginator-range-label">%client-item-index-init – %client-item-index-final of
                        %client-total-items</span>
                      <button disabled title="Previous page"><span class="material-icons">chevron_left</span></button>
                      <button title="Next page"><span class="material-icons">chevron_right</span></button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer">
      <div><strong>Ciência da Computação 3ºP</strong> - Carlos Eduardo, David Igor, Gabriel Coelho, Mariana Lorena e Vinícius Oliveira.</div>
    </div>
  </footer>

  <div class="modal fade" id="meuModal" tabindex="-1" aria-labelledby="tituloModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-sm rounded-2xl">
        <div class="modal-header border-0">
          <h5 class="modal-title" id="tituloModal">Detalhes</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
          <ul class="list-group" id="modalBodyList"></ul>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    document.querySelectorAll('.nav-link').forEach(function (tab) {
      tab.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelectorAll('.nav-tabs li').forEach(li => li.classList.remove('active'));
        document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
        document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
        this.classList.add('active');
        this.parentElement.classList.add('active');
        document.getElementById(this.getAttribute('data-tab')).classList.add('active');
      });
    });

    const bootstrapModal = new bootstrap.Modal(document.getElementById('meuModal'));

    function openModal(dataArray, isEnd) {
      const ul = document.getElementById('modalBodyList');
      ul.innerHTML = '';

      const labels = [
        'Ordem de Serviço', 'Cliente', 'CPF', 'Endereço', 'Telefone',
        'Tipo do Aparelho', 'Marca', 'Modelo', 'S/N', 'Relato',
        'Data do Serviço', 'Descrição Defeito', 'Garantia'
      ];

      dataArray.forEach((value, idx) => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.innerHTML = `<strong>${labels[idx]}:</strong> <span>${value}</span>`;
        ul.appendChild(li);
      });

      const oldBtn = document.getElementById('notifyBtn');
      if (oldBtn) oldBtn.remove();

      if (!isEnd) {
        const notifyBtn = document.createElement('button');
        notifyBtn.id = 'notifyBtn';
        notifyBtn.className = 'btn btn-sm mt-3';
        notifyBtn.textContent = 'Notificar Usuário';
        notifyBtn.style.backgroundColor = '#18a689';
        notifyBtn.style.color = '#fff';
        notifyBtn.onclick = function () {
          let message = "";
          if (window.app && typeof window.app.notifyUser === 'function') {
            message = window.app.notifyUser(dataArray[0] - 1);
          }
          const toastContainer = document.getElementById('toastContainer') || (() => {
            const div = document.createElement('div');
            div.id = 'toastContainer';
            div.style.position = 'fixed';
            div.style.bottom = '30px';
            div.style.right = '30px';
            div.style.zIndex = '9999';
            document.body.appendChild(div);
            return div;
          })();

          const toast = document.createElement('div');
          toast.className = 'toast align-items-center text-bg-success border-0 show';
          toast.setAttribute('role', 'alert');
          toast.setAttribute('aria-live', 'assertive');
          toast.setAttribute('aria-atomic', 'true');
          toast.style.minWidth = '220px';
          toast.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">${message}</div>
              <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
          `;
          toastContainer.appendChild(toast);

          setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 300);
            bootstrapModal.hide();
            if (window.app && typeof window.app.loadHtmlWithData === 'function') {
              window.app.loadHtmlWithData();
            }
          }, 5000);
        };
        ul.parentElement.appendChild(notifyBtn);
      }

      bootstrapModal.show();
    }
  </script>
</body>

</html>